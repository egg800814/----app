# 尾牙抽獎轉盤程式 (Lucky Wheel App)

## 專案簡介
這是一個專為公司 90 週年尾牙活動設計的互動式抽獎轉盤程式。系統分為「後台控制端」與「大螢幕顯示端」，支援雙螢幕操作，讓工作人員在後台即時管理名單、獎項與控制流程，同時讓前台觀眾享受流暢的視覺抽獎體驗。

## 系統特色
*   **雙螢幕支援**：控制端與顯示端分離，確保活動流暢進行。
*   **高質感視覺**：包含平滑轉動物理引擎、速度線特效、聚光燈、LED 跑馬燈與中獎煙火特效。
*   **彈性設定**：可即時編輯獎項、調整參加人員名單，並支援「打散排序」。
*   **互動性**：支援滑鼠長按蓄力轉動、敲擊互動游標。
*   **物理微調**：提供滑行阻力與擋板阻力調整，可控制轉盤轉動的節奏。
*   **安全機制**：
    *   自動存檔：名單與獎項變更會自動寫入 `program/data.json`。
    *   防呆設計：中獎後需確認歸檔，才會從名單中移除，避免誤操作。
    *   死區防止：特殊的磁力歸中與防停轉機制，確保指針不會停在模糊地帶。

## 快速開始
1.  **環境需求**：Windows 10/11, Python 3.8+ (若執行 EXE 則不需要)
2.  **啟動程式**：
    *   直接執行 `program/main.py`
    *   或執行打包後的 EXE 檔案
3.  **視窗配置**：
    *   程式啟動後會出現兩個視窗。
    *   **後台控制系統 (Operator Console)**：請保留在主螢幕供工作人員操作。
    *   **大螢幕抽獎 (Display Window)**：請拖曳至投影機或第二螢幕，並按兩下視窗標題列使其全螢幕 (系統會嘗試自動定位)。

## 操作說明書

### 1. 後台控制系統 (Control Window)
這是工作人員的主要操作介面，功能如下：

#### A. 獎項設定 (左上區塊)
*   **下拉選單**：選擇目前要抽的獎項（如：總經理獎、社長獎）。
*   **修改/刪除**：可即時更名或刪除現有獎項。
*   **追加新獎項**：在輸入框輸入名稱後點擊「追加」即可。
*   **設定抽獎人頭像**：點擊橘色按鈕，選擇一張照片（JPG/PNG）。該照片會顯示在轉盤中央，代表該獎項的頒獎人。

#### B. 名單管理 (左中區塊)
*   **名單編輯區**：顯示目前還在轉盤上的參加人員。您可以直接在此文字框內手動貼上或修改名單（一行一個名字）。
*   **打散名單排序**：點擊後會將目前名單順序隨機打亂，並立即更新預覽。
*   **儲存並更新名單**：**重要！** 修改完名單後，請務必按下此按鈕，系統才會將新名單存檔並同步到預覽與大螢幕。

#### C. 轉速與阻力微調 (左下區塊)
*   **滑行阻力 (Base Friction)**：控制轉盤在空轉時的滑行距離。數值越大滑越遠。
*   **撞擊阻力 (Peg Friction)**：模擬指針撞到擋板的阻力。數值越小阻力越大（煞車越快）。
*   **恢復預設值**：若調整亂了，可按此鈕恢復原廠設定。

#### D. 發布與控制 (底部區塊)
*   **發布設定到大螢幕**：當您在後台設定好獎項、圖片或名單後，**必須**點擊此按鈕，大螢幕才會更新顯示。這是為了避免後台操作過程被觀眾看到的貼心設計。
*   **系統端啟動 (START)**：工作人員可直接點擊此按鈕代為抽獎（適用於無人互動時）。

#### E. 即時預覽 (右側區塊)
*   **預覽轉盤**：顯示目前大螢幕上的轉盤狀態。
*   **Live Output**：右下角的小視窗會即時監控大螢幕的畫面截圖，讓工作人員不用回頭看投影幕。

---

### 2. 大螢幕顯示端 (Display Window)
這是給觀眾看的畫面：
*   **轉盤區**：顯示五彩繽紛的轉盤，中央顯示目前獎項或抽獎人照片。
*   **榮譽榜**：右側半透明區塊，顯示已經中獎的人員名單。
*   **互動操作**：
    *   滑鼠游標會變成「槌子」。
    *   移到轉盤中央會顯示 "START"。
    *   **長按左鍵**：轉盤會開始蓄力加速。
    *   **放開左鍵**：轉盤開始自由旋轉，最後受物理阻力停下。

### 3. 中獎流程
1.  轉盤停止後，會先在大螢幕跳出中獎者特效與姓名大字。
2.  同時，後台會跳出「中獎確認」視窗：
    *   **確認 (Confirm)**：確認中獎。系統會播放彩帶特效，將名字以動畫飛入右側榮譽榜，並**從轉盤名單中移除**該員。
    *   **保留 (Cancel)**：不算此次結果（例如誤觸）。名單**不會**被移除，轉盤重置供重新抽獎。

## 常見問題 (FAQ)
*   **Q: 如何重新開始？**
    *   A: 只要關閉程式重新開啟，程式會讀取 `data.json`，名單會維持上次關閉前的狀態（已中獎的不會回來）。若要全新開始，請在名單管理區貼上原始完整名單並「儲存」。
*   **Q: 音效沒有出來？**
    *   A: 請確認電腦音量已開啟，且 `assets/sounds` 資料夾內有 `win2.wav` 或 `win.wav` 等檔案。系統優先支援 WAV 格式，若有 MP3 建議轉檔。
*   **Q: LOG 檔去哪了？**
    *   A: 為避免佔用空間，目前系統已關閉自動日誌 (Log) 功能。

---
**祝 90 週年尾牙活動順利，大獎抽不停！**
